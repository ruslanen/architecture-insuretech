# Задание 4

Сервис оформления ОСАГО построен по асинхронной событийной архитектуре с использованием Apache Kafka. 
Это обеспечивает масштабируемость, отказоустойчивость и минимальное время отклика для отображения предложений страховых компаний пользователю по мере их поступления.

## Основной сценарий взаимодействия:
1. Инициация заявки
- Пользователь через веб-интерфейс core-приложения отправляет данные об автомобиле и водителе.
- core-app публикует событие OSAGO.RequestInitiated в Kafka, содержащее requestId, данные пользователя и автомобиля.

2. Обработка заявки агрегатором
- Сервис osago-aggregator подписан на топик Kafka и получает событие заявки.
- Он сохраняет информацию о заявке и статусах запросов к страховым компаниям в свою БД.
- Далее он параллельно отправляет запросы в REST API всех доступных страховых компаний.

3. Публикация предложений
- По мере получения предложений от страховых компаний osago-aggregator публикует отдельные события OSAGO.ProposalReceived в Kafka с деталями предложения и requestId.

4. Обновление интерфейса пользователя
- core-app подписан на Kafka-топик с ответами и фильтрует события по requestId.
- Полученные предложения отображаются на клиенте по мере поступления.

## Особенности
1. Интеграция между сервисами асинхронная (pub/sub)
2. У osago-aggregator есть собственное хранилище — для сохранения статусов и результатов взаимодействия с внешними страховыми сервисами
3. Поддерживается высокая нагрузка через параллелизм и отказ от синхронных вызовов
4. Предложения отображаются по мере поступления, без необходимости дожидаться всех результатов
5. Добавляется таблица на стороне БД core-app для сохранения промежуточных результатов (к примеру, если клиент переподключится или будут ошибки от каких-то внешних сервисов).
